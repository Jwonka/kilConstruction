---
type Photo = {
    id: string;
    name: string;
    full: string;
    thumb: string;
    createdTime: string;
};

const api = import.meta.env.PUBLIC_GALLERY_API as string;

let items: Photo[] = [];
let loadError: string | null = null;
try {
    const res = await fetch(api, { cache: 'reload' });
    if (res.ok) {
        const json = (await res.json()) as { items?: Photo[] };
        items = json.items ?? [];
    } else {
        loadError = `HTTP ${res.status}`;
    }
} catch (err: any) {
    loadError = err?.message ?? 'Network error';
}
---

<section class="gallery grid-cards">
    {items.length > 0 ? (
        items.map((i) => (
                <a class="card card-photo" href={i.full} target="_blank" rel="noopener">
                    <img class="photo" loading="lazy" src={i.thumb} alt={i.name} />
                </a>
        ))
    ) : (
            <p>No images uploaded yet.</p>
    )}
</section>

