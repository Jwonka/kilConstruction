---
import "../styles/global.css";
import "../styles/nav.css";
import Nav from "../components/Nav.astro";
import logo from "../assets/og-image_1200x630.jpg";
const {
    title = "KIL Construction",
    description = "Custom cabinetry, built-ins, and remodeling projects in Mondovi.",
    image = logo.src,
    url, // optional override
    noSticky = false,
} = Astro.props;

// Canonical URL: always strip query/hash by using pathname.
// Astro.site (configured in astro.config.mjs) for absolute URLs.
const canonicalUrl = Astro.site
    ? new URL(Astro.url.pathname, Astro.site).toString()
    : (Astro.url ? Astro.url.origin + Astro.url.pathname : "https://kilcon.work");

// Allow explicit override if a page *really* needs it.
const pageUrl = typeof url === "string" && url.length > 0 ? url : canonicalUrl;

const absoluteImage = image.startsWith("http")
    ? image
    : new URL(image, pageUrl).toString();
---
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={absoluteImage} />
    <meta property="og:url" content={pageUrl} />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={absoluteImage} />
    <meta name="referrer" content="strict-origin">
    <link rel="canonical" href={pageUrl} />
    <link rel="icon" href={logo.src} />
</head>
<body class={`site ${noSticky ? 'no-sticky' : ''}`}>
<header class="header"><div class="container"><Nav /></div></header>

<main class="container">
    <slot />
</main>

<footer class="footer">
    <div class="container">
        <div class="footer-inner">
            <div class="footer-top">
                <span class="foot-copy">
                    © {new Date().getFullYear()} KIL Construction · Licensed & Insured · Serving Mondovi, WI and The Surrounding Area
                </span>
                <div class="footer-actions">
                    <a class="fb" href="https://www.facebook.com/profile.php?id=61559555097375" target="_blank" rel="noopener noreferrer" aria-label="KIL Construction on Facebook">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill-opacity="currentColor" aria-hidden="true">
                            <path d="M22 12a10 10 0 1 0-11.5 9.9v-7h-2v-2.9h2v-2.2c0-2 1.2-3.2 3-3.2.9 0 1.8.1 1.8.1v2h-1c-1 0-1.3.6-1.3 1.2v2h2.3l-.4 2.9h-1.9v7A10 10 0 0 0 22 12z"/>
                        </svg>
                    </a>

                    <div class="footer-apparel">
                        <a href="/apparel/">Order KIL apparel</a>
                    </div>
                </div>
            </div>

            <nav class="footer-legal" aria-label="Legal">
                <a href="/privacy">Privacy Policy</a>
                <a href="/terms">Terms of Use</a>
            </nav>
        </div>
        <div class="footer-admin">
            <a href="/admin">Admin</a>
        </div>
    </div>
</footer>
</body>
</html>
